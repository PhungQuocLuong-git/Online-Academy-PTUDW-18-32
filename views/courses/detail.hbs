{{#section 'css'}}
<link href="https://vjs.zencdn.net/7.10.2/video-js.css" rel="stylesheet"/>
<link rel="stylesheet" href="/public/stylesheets/home.css">
<link rel="stylesheet" href="/public/stylesheets/form.css">
<link rel="stylesheet" href="/public/stylesheets/toast.css">
<style>
  /* course-intro */
  .course-detail {
    height: 32vw;
    background-color: #3659a2;
  }

  .course-detail-img {
    margin-top: 13%;
    border-radius: 6px;
    overflow: hidden;
  }

  .img-fluid {
    max-height: 350px;
    width: 100%;
    background-image: cover;
  }

  /* Tooltip custom */
  .tooltip-inner {
    background-color: #37294c;
  }

  .tooltip.bs-tooltip-right .arrow:before {
    display: none;
  }

  .tooltip.bs-tooltip-left .arrow:before {
    display: none;
  }

  .tooltip.bs-tooltip-bottom .arrow:before {
    display: none;
  }

  .tooltip.bs-tooltip-top .arrow:before {
    display: none;
  }

  /* Tab */
  .show {
    color: #37294c;
  }

  .nav-tabs .active {
    color: #f0f0f0 !important;
    background-color: #3659a2 !important;
    border-bottom: solid 5px !important;
  }

  .nav-tabs .active:hover {
    color: #ccc !important;
  }

  .nav-link {
    color: #f0f0f0;
    font-weight: 500;
  }

  .nav-tabs .nav-link {
    border: none;
  }

  .nav-link:hover {
    color: #ccc;
  }

  /* Tab content*/

  .tab-content {
    color: #37294c;
    width: 50%;
  }

  /* description */

  ul {
    list-style: none;
  }

  .tab-content .active {
    animation: fadeInLeft 0.7s;
  }

  @keyframes fadeInLeft {
    0% {
      opacity: 0;
      transform: translateX(-20px);
    }

    100% {
      opacity: 1;
      transform: translateX(0);
    }
  }

  .tab-pane>p,
  li {
    color: black;
  }

  /* Accordition */
  .accordion {
    background-color: white;
    color: #444;
    cursor: pointer;
    padding: 18px;
    width: 100%;
    border: none;
    text-align: left;
    outline: none;
    font-size: 15px;
    transition: 0.4s;
    border-radius: 6px;
    margin-top: 20px;
    box-shadow: rgba(100, 100, 111, 0.2) 0px 7px 29px 0px;
    font-size: large;
    font-weight: 500;
  }

  .accordion:focus {
    outline: 0px;
  }

  .acor-active {
    border-radius: 8px 8px 0 0;
    box-shadow: rgba(100, 100, 111, 0.2) 0px 0px 0px 0px;
  }

  .acor-active+.panel {
    border-radius: 0 0 8px 8px;
    box-shadow: rgba(100, 100, 111, 0.2) 0px 7px 29px 0px;
  }

  .accordion:after {
    content: "\f107";
    font-family: "Font Awesome 5 Free";
    color: #777;
    font-weight: bold;
    float: right;
    margin-left: 5px;
  }

  .acor-active:after {
    border: none;
    content: "\f106";
    font-family: "Font Awesome 5 Free";
  }

  .panel {
    padding: 0 18px;
    background-color: white;
    max-height: 0;
    overflow: hidden;
    transition: max-height 0.2s ease-out;
  }

  .panel li {
    font-size: large;
    font-weight: 400;
    padding-left: 40px;
  }

  .panel li:before {
    content: "\f144";
    font-family: "Font Awesome 5 Free";
    position: relative;
    left: -20px;
  }

  /* Overlay */
  .overlay {
    position: relative;
  }

  .image-overlay {
    opacity: 1;
    display: block;
    width: 100%;
    height: auto;
    transition: 0.5s ease;
    backface-visibility: hidden;
  }

  .middle {
    transition: 0.5s ease;
    opacity: 0;
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    -ms-transform: translate(-50%, -50%);
    text-align: center;
  }

  .overlay:hover .middle {
    opacity: 1;
  }

  .text {
    color: white;
    font-size: 100px;
  }

  iframe {
    display: block;
  }


  /* Instructor */
  .instructor-name {
    color: #3659a2;
  }

  .intructor-first-des {
    font-size: medium;
    font-weight: 600;
    color: #777 !important;
  }


  /* Progress */
  .progress {
    background-color: #ccc !important;
  }

  /* Feedback */
  .feedback-rating {
    width: 8.5rem;
    height: 8.5rem;
    overflow: hidden;
    border-radius: 7px;
    box-shadow: rgba(0, 0, 0, 0.24) 0px 3px 8px;
  }

  .review-image-div {
    width: 4rem;
    height: 4rem;
    overflow: hidden;
  }

  .review-image {
    height: 4rem;
    margin-left: 50%;
    transform: translateX(-50%);
  }

  .comment-content {
    font-weight: 600;
    font-size: 16px;
  }

  .comment-content>p {
    font-weight: 200;
    font-size: 15px;
    color: #777;
  }

  .number-rates {
    color: #8c8b8b;
    font-weight: 400;
    align-self: center;
  }

  .rate,
  .rateToSubmit {
    font-size: 25px;
    font-family: sans-serif;
    color: #ff8000;
    margin-left: 20px;
    margin-right: 20px;
  }

  .number-students {
    color: #8c8b8b;
    font-weight: 400;
    align-self: center;
    margin-left: 5px;
  }
/*Modal */

.modal__overlay{
    position: absolute;
    width:100%;
    height: 100%;
    background-color: rgba(0,0,0,0.4);
}

.modal__body{
    --grow-from:0.7;
    --grow-to:1;
    
    z-index: 1;
    margin:auto;
   animation: growth linear 0.1s ;
}
  /* Auth Form*/
  .auth-form{
    width:500px;
    background-color:#fff;
    border-radius: 5px;
    overflow: hidden;
}
.auth-form__container{
    padding: 0 32px;
}

.auth-form__header{
    display:flex;
    align-items: center;
    justify-content: space-between;
    padding:12px 12px;
}

.auth-form__heading{
    font-size: 24px;
    font-weight: 400;
    color: #333;
}

.auth-form__switch-btn{
    font-size: 18px;
    color:#eb3b5a; 
    font-weight: 700;
    cursor: pointer;
}

.auth-form__form{
    margin-top:16px;
}

.auth-form__input{
    height:40px;
    width:100%;
    padding:0 12px;
    font-size: 16px;
    border: 1px solid #dbdbdb;
    border-radius: 4px;
    outline:none;
}

.auth-form__input:focus{
    border-color: #777;
}

.auth-form__aside{
    margin-top: 18px;
}

.auth-form__policy-text{
    padding: 0 12px;
    font-size: 14px;
    line-height: 18px;
    text-align: center;
}

.auth-form__text-link{
    text-decoration: none !important;
    color:#eb3b5a;
}

.auth-form__text-link:hover{
  color: #f35673;
}

.auth-form__controls{
    margin-top: 80px;
    display: flex;
    justify-content: flex-end;
}

.auth-form__controls-back{
    margin-right: 8px;
}

.auth-form__socials{
    background-color: #f5f5f5;
    padding:16px 36px;
    display: flex;
    justify-content: space-between;
    margin-top: 24px;
}

.auth-form__socials-icon{
    font-size: 20px;
}

.auth-form__socials--facebook{
    color: #fff;
    background-color: #3A5A98;
}

.auth-form__socials--google{
    background-color: #fff;
    color:#666
}
.auth-form__socials-title{
    margin: 0 36px;
}

.auth-form__help{
    display: flex;
    justify-content: flex-end;
}

.auth-form__help-link{
    text-decoration: none;
    font-size: 16px;
    color: #939393;
}

.auth-form__help-seperate{
    display: block;
    height: 22px;
    border-left: 1px solid #EAEAEA;
    margin: 1px 16px 0;
}

.auth-form__help-forgot{
    color:#eb3b5a;
}
.auth-form__help-link{
  text-decoration: none !important;
    color:#eb3b5a;
}

.auth-form__help-link:hover{
  color: #ee4d6a;
}
.form-label{
  font-weight: 700;
    line-height: 20px;
    font-size: 16px;
}
.btn-handle-auth{
  background-color: #eb3b5a;
  color:  #fff;
    border-color:  #eb3b5a;
}
.btn-handle-auth:hover{
    border-color:  #e26078;
  background-color: #e26078;

}
</style>
{{/section}}
<div id="toast"></div>

<!-- info -->
<div class="container-fluid course-detail d-flex">
  <div class="mx-auto d-flex w-75">
    <div class="col-6 d-flex flex-column">
      <div class="p-0 overlay course-detail-img">
        <img class="img-fluid" src="{{course.thumbnail}}" alt="">
        <div class="middle">
          <div class="text my-auto"><a href="#course-video" data-toggle="modal" class="text-dark"><i
                class="fas fa-play"></i></a></div>
        </div>
      </div>
      <ul class="nav nav-tabs mt-auto border-0" role="tablist">
        <li class="nav-item">
          <a class="nav-link active" data-toggle="tab" href="#description">Description</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" data-toggle="tab" href="#curriculum">Curriculum</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" data-toggle="tab" href="#instructor">Instructor</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" data-toggle="tab" href="#feedback">Feedback</a>
        </li>
      </ul>
    </div>
    <div class="h-75 d-inline-block align-self-center ml-auto text-white" style="width: 45%;">
      <h3 class="font-weight-bold">{{course.name}}</h3>

      {{{course.short_description}}}

      <div class="d-flex text-warning mt-3">
        {{#ifgreater course.discount_price 0}}
        <h3 class="delete-price text-dark">${{course.price}}</h3>
        <h3 class="ml-4">${{course.discount_price}}</h3>
        {{else}}
        <h3 class="text-warning">${{course.price}}</h3>
        {{/ifgreater}}
        {{#ifequal role 1}}
        <h3 class="mx-auto"><a class="btn-wish" data-id="{{course._id}}" data-toggle="tooltip" data-placement="top"
            title="Add to Wishlist"><i class="fa-heart text-danger wish-icon"></i></a></i></h3>
        {{/ifequal}}
      </div>
      <div class="d-flex">
        <span class="number-rating bg-warning text-white px-2 h-75 align-self-center"
          style="border-radius: 5px;">{{#if course.rating}}{{course.rating}}{{else}}0{{/if}}</span>
        <div class="rate" data-rate-value={{course.rating}}></div>
        <span class="number-rates"><i class="fas fa-users"></i> {{course.course_students.length}}</span>
      </div>
      <p class="mt-3">Created by <strong>{{course.course_author.name}}</strong> </p>
      <div class="d-flex">
        <p><i class="far fa-edit"></i> Last updated {{dateFormat course.lastUpdated}} </p>
      </div>
      {{#ifCond isBooked '===' false}}
      <button type="button" class="btn btn-add-cart btn-danger btn-lg w-40" data-id="{{course._id}}"
      {{#ifCond role "===" 0}}data-toggle="modal" data-target="#loginModal" {{/ifCond}}>Add to
        cart</button>
      <button type="button" class="btn-book-course btn btn-primary btn-lg ml-5 w-40" data-id="{{course._id}}"
      {{#ifCond role "===" 0}}data-toggle="modal" data-target="#loginModal" {{/ifCond}}
      >Buy now</button>
      {{else}}
      {{#ifCond role '===' 1}}
      <h3 class="mt-3" style="color:#ccf381">Enjoy this course!!!</h3>
      {{/ifCond}}
      {{/ifCond}}
    </div>
  </div>

</div>

<div class="container-fluid d-flex justify-content-center pt-4" style="background-color: #EDEFF0;min-height:700px">
  <div class="tab-content px-0">
    <div id="description" class="container tab-pane active"><br>
      <h3>Description</h3>
      {{{course.description}}}
    </div>
    <div id="curriculum" class="container tab-pane fade"><br>
      {{#ifCond isBooked '||' isTeacher}}
      {{#each course.curriculum}}
      <button class="accordion">{{chapter_name}}</button>
      <div class="panel p-0">
        <ul class="list-group">
          {{#each lectures}}
          
          <a 
          href="#{{_id}}" data-toggle="modal" style="text-decoration: none;" class="process" data-process="/student/updateprocess/{{../../course._id}}/{{_id}}"
            >
            <li class="list-group-item list-group-item-action border-0">
              {{name}}
              
              {{#ifCond iswatch '===' 1}}
                <p style="color: green;" >
                  <i class="far fa-check-circle float-right" aria-hidden="true" style="bottom: 20px; position: relative;"></i>
                </p>
              {{/ifCond}}
             
              </li>
          </a>
          {{/each}}
        </ul>
      </div>
      {{/each}}
      {{else}}
      {{#each course.curriculum}}
      <button class="accordion">{{chapter_name}}</button>
      <div class="panel p-0">
        <ul class="list-group">
          {{#each this.lectures}}
          
          {{#if this.preview}}
          <a href="#{{_id}}" data-toggle="modal" style="text-decoration: none;">
              <li class="list-group-item list-group-item-action border-0">
                {{name}}
                    <span><span class="badge badge-success px-2 py-1 ml-2">Preview</span></span>
              </li>
          </a>
          {{else}}
            <a {{#ifCond ../../role "===" 0}}href="#loginModal" data-toggle="modal" {{else}} name="booknt"{{/ifCond}}  style="text-decoration: none;" class="process">
          <li   class="list-group-item list-group-item-action border-0" id='msg-alert'>
              
              {{name}}
          </li>
              </a>
          
          {{/if}}


          {{/each}}
        </ul>
      </div>

      {{/each}}
      {{/ifCond}}


    </div>
    <div id="instructor" class="container tab-pane fade"><br>
      <h3 class="instructor-name">{{course.course_author.name}}</h3>
      <p class="intructor-first-des">{{course.course_author.short_description}}</p>
      <div class="row">
        <img src="/public/images/avatars/avatar-2.jpeg" class="rounded-circle ml-2 mb-4" alt="">
        <div class="d-flex col-6">
          <div class="text-danger d-flex flex-column justify-content-around">
            <p><i class="fas fa-users"></i> </p>
            <p><i class="fas fa-play-circle"></i> </p>
            <p><i class="fas fa-user"></i> </p>
          </div>
          <div class="col-8 d-flex flex-column justify-content-around">
            <p>{{course.course_author.NumOfStudents}} Applied</p>
            <p>{{course.course_author.posted_courses.length}} Courses</p>
            <p>Has joined in {{dateFormat course.course_author.createdAt}}</p>
          </div>
        </div>
        {{{course.course_author.description}}}
      </div>
    </div>
    <div id="feedback" class="container tab-pane fade pl-0"><br>
      <h3>Student rates</h3>
      <div class="row my-3 ml-1">
        <div class="d-flex flex-column align-items-center bg-light feedback-rating">
          <h1 class="mt-2 mb-0">{{course.rating}}</h1>
          <div class="rate text-dark" data-rate-value={{course.rating}}></div>
          <p class="mb-2">Course Rating</p>
        </div>
        <div class="col-7 d-flex flex-column justify-content-around">
          <div class="progress h-10">
            <div class="progress-bar" role="progressbar" id="pb5" style="width: 0%"></div>
          </div>
          <div class="progress h-10">
            <div class="progress-bar" role="progressbar" id="pb45" style="width: 0%"></div>
          </div>
          <div class="progress h-10">
            <div class="progress-bar" role="progressbar" id="pb4" style="width: 0%"></div>
          </div>
          <div class="progress h-10">
            <div class="progress-bar" role="progressbar" id="pb35" style="width: 0%"></div>
          </div>
          <div class="progress h-10">
            <div class="progress-bar" role="progressbar" id="pblqt3" style="width: 0%"></div>
          </div>
        </div>
        <div class="col d-flex flex-column justify-content-around">
          <div class="d-flex">
            <span class="align-self-center mr-2" id="_5">0 voted </span>
            <span class="align-self-center">5 <i class="fas fa-star text-warning"></i></span>
          </div>
          <div class="d-flex">
            <span class="align-self-center mr-2" id="_45">0 voted </span>
            <span class="align-self-center">4.5 <i class="fas fa-star text-warning"></i></span>
          </div>
          <div class="d-flex">
            <span class="align-self-center mr-2" id="_4">0 voted </span>
            <span class="align-self-center">4 <i class="fas fa-star text-warning"></i></span>
          </div>
          <div class="d-flex">
            <span class="align-self-center mr-2" id="_35">0 voted </span>
            <span class="align-self-center">3.5 <i class="fas fa-star text-warning"></i></span>
          </div>
          <div class="d-flex">
            <span class="align-self-center mr-2" id="_lqt3">0 voted </span>
            <span class="align-self-center">≤ 3 <i class="fas fa-star text-warning"></i></span>
          </div>
        </div>
      </div>
      <h3>Reviews</h3>
      {{#if course.rates}}
      <ul class="p-0 my-4">
        {{#each course.rates}}
        <li>
          <div class="d-flex">
            <div class="rounded-circle review-image-div">
              <img src="{{student_avatar}}" class="review-image">
            </div>
            <div class="col-8 comment-content">
              {{student_name}}
              <p>Student</p>
            </div>
            <div class='rate' data-rate-value={{rate_value}}></div>
          </div>
          <div class="offset-1 col-11 mt-2">
            <p>{{comment}}</p>
          </div>
        </li>
        <br>
        {{/each}}
      </ul>
      {{else}}
      <h5>No one has rated this course</h5>
      {{/if}}
      {{#if isStudent}}
      <h3>Submit reviews</h3>
      <form action="/courses/rate/{{course.slug}}" method="POST" id="feedback_form">
        <div class="my-4">

          <div class="d-flex">
            <div class="rounded-circle review-image-div">
              <img src="{{user.avatar}}" class="review-image">
            </div>
            <div class="col-5 comment-content">
              {{user.name}}
              <p>Student</p>
            </div>
            <div class="col rate-message text-danger"></div>
            <div class='rateToSubmit' id="rate"></div>
            <input type="hidden" id="rate_value" name="rate_value" value='0'>
          </div>
          <div class="offset-1 col-11 mt-2 form-group">
            <label for="comment">Comment</label>
            <textarea class="form-control" id="comment" name="comment"></textarea>
            <span class="cmt-message text-danger"></span>
          </div>
          <div class="offset-10">
            <button class="btn btn-primary" type="submit" id="btn-submit">Update feedback</button>
          </div>
        </div>
      </form>
      {{/if}}
    </div>
  </div>

  <div class="col-3 pt-4">
    <h3 class="mb-3 d-block w-75" style="color: #3E416D;margin-left:32px;">Related courses</h3>
    <div class="row d-flex flex-column align-items-center p-0 b-5">
      {{#if mostRelatedPurchased}}
      {{#each mostRelatedPurchased}}
      <div class="col-8 p-0 mb-3">
        <div class="card h-100">
          <img class="card-img-top" src="{{thumbnail}}" alt="Card image cap">
          <div class="card-body d-flex flex-column">
            <p class="card-text text-primary font-weight-bold">Web Development</p>
            <h6 class="card-title font-weight-bold">{{name}} </h6>
            <p class="card-subtitle text-secondary teacher-text">{{course_author.name}}</p>
            <div class="card-text d-flex">
            <div class="rate m-0" data-rate-value={{rating}}></div>
            <span class="number-students"><i class="fas fa-users"></i> {{course_students.length}}</span>
            </div>
            <div class="d-flex">
              {{#if discount_price}}
              <h5 class="card-text font-weight-bold delete-price"> ${{price}} </h5>
              <h5 class="card-text font-weight-bold align ml-3 discout-price"> ${{discount_price}}
              {{else}}
              <h5 class="card-text font-weight-bold"> ${{price}} </h5>
              {{/if}}
              </h5>
            </div>
            <a href="/courses/{{slug}}" class="btn btn-primary align-self-start mt-auto">Go to
              course</a>
          </div>
        </div>
      </div>
      {{/each}}
      {{else}}
      <h5></h5>
      {{/if}}
    </div>
  </div>
</div>


<!-- Modal -->
{{#ifCond course.preview_video '!==' ''}}
<div class="modal fade" id="course-video" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle"
  aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content m-0" style="width: 608px;">
      <div class="modal-header">
        <div>
          <h6 class="modal-title" id="exampleModalLongTitle">Courses Preview</h6>
          <h4 class="model-title"> {{course.name}}</h4>
        </div>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body p-0">
        <video id="my-video" class="video-js" controls preload="auto" width="608" height="342" data-setup="{}">
          <source src="{{course.preview_video}}" type="video/mp4"/>
          <source src="MY_VIDEO.webm" type="video/webm" />
          <p class="vjs-no-js">
            To view this video please enable JavaScript, and consider upgrading to a
            web browser that
            <a href="https://videojs.com/html5-video-support/" target="_blank">supports HTML5 video</a>
          </p>
        </video>
      </div>
    </div>
  </div>
</div>
{{else}}
<div class="modal fade" id="course-video" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle"
  aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content m-0" style="width: 608px;">
      <div class="modal-header">
        <div>
          <h6 class="modal-title" id="exampleModalLongTitle">Courses Preview</h6>
          <h4 class="model-title"> {{course.name}}</h4>
        </div>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body p-0">
        <h5> Preview video chua duoc dang</h5>
      </div>
    </div>
  </div>
</div>
{{/ifCond}}

{{#each course.curriculum}}
{{#each this.lectures}}
{{#ifCond link '===' ''}}
<div class="modal fade" id="{{_id}}" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle"
  aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content m-0" style="width: 608px;">
      <div class="modal-header">
        <div>
          <h4 class="modal-title" id="exampleModalLongTitle">{{name}}</h4>
        </div>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body p-0">
        <h5> Video cua bai giang nay chua duoc dang</h5>
        {{{description}}}
      </div>
    </div>
  </div>
</div>
{{else}}
<div class="modal fade" id="{{_id}}" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle"
  aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content m-0" style="width: 608px;">
      <div class="modal-header">
        <div>
          <h4 class="modal-title" id="exampleModalLongTitle">{{name}}</h4>
        </div>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body p-0">
        <video id="my-video" class="video-js" controls preload="auto" width="608" height="342" data-setup="{}">
          <source src="{{link}}" type="video/mp4" />
          <source src="MY_VIDEO.webm" type="video/webm" />
          <p class="vjs-no-js">
            To view this video please enable JavaScript, and consider upgrading to a
            web browser that
            <a href="https://videojs.com/html5-video-support/" target="_blank">supports HTML5 video</a>
          </p>
        </video>

        {{{description}}}
      </div>
    </div>
  </div>
</div>
{{/ifCond}}
{{/each}}
{{/each}}
{{#ifCond role "===" 0}}
  <div class="modal fade" id="registerModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header ">
          <h3 class="auth-form__heading">Đăng ký</h3>
          <span class="auth-form__switch-btn" data-toggle="modal" data-target="#loginModal" data-dismiss="modal">Đăng nhập</span>

      </div>
      <div class="modal-body">
        <form action="/student/store" method="POST" class="form" id="form-2">

          <div class="auth-form__form">
            <div class="auth-form__group form-group ">
              <input id="name" name="name" type="text" placeholder="Tên của bạn" class="auth-form__input form-control">
              <span class="form-message"></span>
            </div>
            <div class="auth-form__group form-group ">
              <input id="email" name="email" type="text" placeholder="Email của bn" class="auth-form__input form-control">
              <span class="form-message"></span>
            </div>
            <div class="auth-form__group form-group ">
              <input id="password" name="password" type="password" placeholder="Mật khẩu" class="auth-form__input form-control">
              <span class="form-message"></span>
            </div>
            <div class="auth-form__group form-group ">
              <input id="password_confirmation" name="password_confirmation" type="password" placeholder="Nhập lại mk" class="auth-form__input form-control">
              <span class="form-message"></span>
            </div>
      </div>
      <div class="auth-form__aside">
          <p class="auth-form__policy-text">
              Bằng việc đăng kí, bạn đã đồng ý với Shopee về
              <a href="" class="auth-form__text-link"> Điều khoản dịch vụ</a>& 
              <a href="" class="auth-form__text-link"> Chính sách bảo mật</a>
          </p>
      </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary auth-form__controls-back "data-dismiss="modal" aria-label="Close">TRỞ LẠI</button>
        <button class="btn  btn-handle-auth ">ĐĂNG KÝ</button>
      </div>
        </form>
    </div>
  </div>
</div>


<div class="modal fade" id="loginModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h3 class="auth-form__heading">Đăng nhập</h3>
          <span class="auth-form__switch-btn" data-toggle="modal" data-target="#registerModal" data-dismiss="modal">Đăng ký</span>
      </div>
      <div class="modal-body">
        <form action="/student/check" method="post" id="form-3">
        
          <div class="auth-form__form">
            <div class="auth-form__group form-group ">
                <input id="email2"  name="email" type="text" placeholder="Email cũa bn" class="auth-form__input form-control">
                <span class="form-message"></span>
              </div>
              <div class="auth-form__group form-group ">
                <input id="password2" name="password" type="password" placeholder="Mật khẩu" class="auth-form__input form-control">
                <span class="form-message"></span>
              </div>
          </div>
          <div class="auth-form__aside">
              <div class="auth-form__help">
                  <a href="" class="auth-form__help-link auth-form__help-forgot">
                      Quên mật khẩu
                  </a>
                  <span class="auth-form__help-seperate"></span>
                  <a href="" class="auth-form__help-link">
                      Cần trợ giúp ?
                  </a>
              </div>
          </div>
        </div>
        <div class="modal-footer">
          <button class="btn btn-secondary auth-form__controls-back" data-dismiss="modal">TRỞ LẠI</button>
          <button class="btn  btn-handle-auth ">ĐĂNG NHẬP</button>
        </div>
        </form>
    </div>
  </div>
</div>
{{/ifCond}}


<form name="book-course" method="POST"></form>
<form name="wish-course" method="POST"></form>
<form name="add-course" method="POST"></form>


{{#section 'js'}}
<script src="/public/javascripts/validator.js"></script>
<script src="/public/javascripts/toast.js"></script>
<script src="https://vjs.zencdn.net/7.10.2/video.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@10"></script>

<script>
  $('a[name="booknt"]').on('click',function(){
    Swal.fire({
      title: 'Bạn chưa mua khóa học!',
      text: 'Hãy mua khóa học và quay lại sau nhé',
      icon: 'warning',
      confirmButtonText: 'OK'
    })
  })
  Validator({
      form: '#form-2',
      formGroup: '.auth-form__group',
      errorSelector: '.form-message',
      rules: [
        Validator.isRequired('#email', 'Vui lòng nhập i meo'),
        Validator.isRequired('#name', 'Vui lòng nhập tên của bạn'),
        Validator.isRequired('#password', 'Vui lòng nhập mật khẩu'),
        Validator.isEmail('#email', 'Vui lòng nhập lại i meo'),
        Validator.minLength('#password', 6),
      Validator.isRequired('#password_confirmation'),
      Validator.isConfirmed('#password_confirmation', function () {
        return document.querySelector('#form-2 #password').value;
      }, 'Mật khẩu không khớp')
            ],
            
        }
    )
    Validator({
      form: '#form-3',
      formGroup: '.auth-form__group',
      errorSelector: '.form-message',
      rules: [
        Validator.isRequired('#email2', 'Vui lòng nhập i meo'),
      Validator.isRequired('#password2'),
            ],
      detail:1
        }
    )
  $(document).ready(function () {
    var options = {
      max_value: 5,
      step_size:0.25,
      readonly: true
    }
    $(".rate").rate(options);

    var optionsForSubmit = {
      max_value: 5,
      step_size: 0.5,
      initial_value: 0,
    }
    $(".rateToSubmit").rate(optionsForSubmit);
  });

  {{#ifequal role 1 }}
  function isWished() {
    var heart = $('.btn-wish').data('id');
    return $.getJSON(`/courses/wished?id=${heart}`);
  }

  $('.process').on('click', function () {
        var val= $(this).data('process');
        console.log(val);
        $.post(val, function (data, status) {});
      })


  $(document).ready(function () {
    $('[data-toggle="tooltip"]').tooltip();
    isWished().then(wished => {
      let wishIcon = $('.wish-icon');
      console.log(wished);
      if (wished)
        wishIcon.addClass('fas');
      else
        wishIcon.addClass('far');
    });
  });
  {{/ifequal}}

      //Accordition
      var acc = document.getElementsByClassName("accordion");
      var i;

      for (i = 0; i < acc.length; i++) {
        acc[i].addEventListener("click", function () {
          this.classList.toggle("acor-active");
          var panel = this.nextElementSibling;
          if (panel.style.maxHeight) {
            panel.style.maxHeight = null;
          } else {
            panel.style.maxHeight = panel.scrollHeight + "px";
          }
        });
      }

      {{#ifequal role 1 }}
      var bookForm = document.forms['book-course'];
      var btnBook = $('.btn-book-course');
      btnBook.on('click', function () {
        bookForm.action = '/courses/book/' + btnBook.data('id');
        bookForm.submit();
      })

      var addForm = document.forms['add-course'];
      var btnAdd = $('.btn-add-cart');
      btnAdd.on('click', function () {
        addForm.action = '/courses/add/' + btnAdd.data('id');
        addForm.submit();
      })

      var feedbackForm = document.forms['feedback_form'];
      var btnSubmit = $('#btn-submit');
      btnSubmit.on('click', function (e) {
        let rate_val = $('.rateToSubmit').rate("getValue");
        $('input[name=rate_value]').val(rate_val);
        let cmt = $('#comment').val();
        if (cmt === "") {
          $('.cmt-message').html('Please fill out your comment');
          e.preventDefault();
        }
        if (rate_val === 0) {
          $('.rate-message').html('Please pick your star rated for this course:');
          e.preventDefault();
        }
        if (cmt !== "" && rate_val !== 0) {
          $('input[name=rate_value]').val(rate_val);
          feedbackForm.submit();
        }
      })

      var wishForm = document.forms['wish-course'];
      var btnWish = $('.btn-wish');
      btnWish.on('click', function () {
        isWished().then(wished => {
          let wishIcon = $('.wish-icon');
          if (wished === true) {
            wishIcon.removeClass('fas');
            wishIcon.addClass('far');
            $.post('/courses/wish/' + btnWish.data('id'), $('.btn-wish').serialize());
          }
          else {
            wishIcon.removeClass('far');
            wishIcon.addClass('fas');
            $.post('/courses/wish/' + btnWish.data('id'), $('.btn-wish').serialize());
          }
        });
      });
      {{/ifequal}}

          var rate5 = 0, rate45 = 0, rate4 = 0, rate35 = 0, ratelqt3 = 0;
          {{#each course.rates }}
          {{#ifequal rate_value '5' }}
          rate5++;
          {{else }}
          {{#ifequal rate_value '4.5' }}
          rate45++;
          {{else }}
          {{#ifequal rate_value '4' }}
          rate4++;
          {{else }}
          {{#ifequal rate_value '3.5' }}
          rate35++;
          {{else }}
          ratelqt3++;
          {{/ifequal}}
              {{/ifequal}}
                  {{/ifequal}}
                      {{/ifequal}}
                          {{/each}}
                              var len = {{ course.rates.length }};

                            $('#_5').html(rate5 + ' voted ');
                            $('#_45').html(rate45 + ' voted ');
                            $('#_4').html(rate4 + ' voted ');
                            $('#_35').html(rate35 + ' voted ');
                            $('#_lqt3').html(ratelqt3 + ' voted ');
                            $('#pb5').width((rate5 * 100) / len + '%');
                            $('#pb45').width((rate45 * 100) / len + '%');
                            $('#pb4').width((rate4 * 100) / len + '%');
                            $('#pb35').width((rate35 * 100) / len + '%');
                            $('#pblqt3').width((ratelqt3 * 100) / len + '%');
      {{#ifequal role 0 }}

      {{/ifequal}}
</script>
{{/section}}