{{#section 'css'}}
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css">


<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-fileinput/5.1.3/css/fileinput.min.css">


<style>
    /* course-intro */
    .course-detail {
        height: 32vw;
        background-color: #3659a2;
    }

    .course-detail-img {
        margin-top: 13%;
        border-radius: 6px;
        overflow: hidden;
    }

    .img-fluid {
        max-height: 350px;
        width: 100%;
        background-image: cover;
    }

    /* Tooltip custom */
    .tooltip-inner {
        background-color: #37294c;
    }

    .tooltip.bs-tooltip-right .arrow:before {
        display: none;
    }

    .tooltip.bs-tooltip-left .arrow:before {
        display: none;
    }

    .tooltip.bs-tooltip-bottom .arrow:before {
        display: none;
    }

    .tooltip.bs-tooltip-top .arrow:before {
        display: none;
    }

    /* Tab */
    .show {
        color: #37294c;
    }

    .nav-tabs .active {
        color: #f0f0f0 !important;
        background-color: #3659a2 !important;
        border-bottom: solid 5px !important;
    }

    .nav-tabs .active:hover {
        color: #ccc !important;
    }

    .nav-link {
        color: #62636d;
        font-weight: 500;
    }

    .nav-tabs .nav-link {
        border: none;
    }

    .nav-link:hover {
        color: #ccc;
    }

    /* Tab content*/

    .tab-content {
        color: #37294c;
        width: 80%;
    }

    /* description */

    ul {
        list-style: none;
    }

    .tab-content .active {
        animation: fadeInLeft 0.7s;
    }

    @keyframes fadeInLeft {
        0% {
            opacity: 0;
            transform: translateX(-20px);
        }

        100% {
            opacity: 1;
            transform: translateX(0);
        }
    }

    .tab-pane>p,
    li {
        color: black;
    }

    /* Accordition */
    .accordion {
        background-color: white;
        color: #444;
        cursor: pointer;
        padding: 18px;
        width: 100%;
        border: none;
        text-align: left;
        outline: none;
        font-size: 15px;
        transition: 0.4s;
        border-radius: 6px;
        margin-top: 20px;
        box-shadow: rgba(100, 100, 111, 0.2) 0px 7px 29px 0px;
        font-size: large;
        font-weight: 500;
    }

    .accordion:focus {
        outline: 0px;
    }

    .acor-active {
        border-radius: 8px 8px 0 0;
        box-shadow: rgba(100, 100, 111, 0.2) 0px 0px 0px 0px;
    }

    .acor-active+.panel {
        border-radius: 0 0 8px 8px;
        box-shadow: rgba(100, 100, 111, 0.2) 0px 7px 29px 0px;
    }



    .acor-active:after {
        border: none;
        content: "\f106";
        font-family: "Font Awesome 5 Free";
    }

    .panel {
        padding: 0 18px;
        background-color: white;
        max-height: 0;
        overflow: hidden;
        transition: max-height 0.2s ease-out;
    }

    .panel li {
        font-size: large;
        font-weight: 400;
        padding-left: 40px;
    }

    .panel li:before {
        content: "\f144";
        font-family: "Font Awesome 5 Free";
        position: relative;
        left: -20px;
    }

    /* Overlay */
    .overlay {
        position: relative;
    }

    .image-overlay {
        opacity: 1;
        display: block;
        width: 100%;
        height: auto;
        transition: 0.5s ease;
        backface-visibility: hidden;
    }

    .middle {
        transition: 0.5s ease;
        opacity: 0;
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        -ms-transform: translate(-50%, -50%);
        text-align: center;
    }

    .overlay:hover .middle {
        opacity: 1;
    }

    .text {
        color: white;
        font-size: 100px;
    }

    iframe {
        display: block;
    }


    /* Instructor */
    .instructor-name {
        color: #3659a2;
    }

    .intructor-first-des {
        font-size: medium;
        font-weight: 600;
        color: #777 !important;
    }


    /* Progress */
    .progress {
        background-color: #ccc !important;
    }

    /* Feedback */
    .feedback-rating {
        width: 8.5rem;
        height: 8.5rem;
        overflow: hidden;
        border-radius: 7px;
        box-shadow: rgba(0, 0, 0, 0.24) 0px 3px 8px;
    }

    .review-image-div {
        width: 4rem;
        height: 4rem;
        overflow: hidden;
    }

    .review-image {
        height: 4rem;
        margin-left: 50%;
        transform: translateX(-50%);
    }

    .comment-content {
        font-weight: 600;
        font-size: 16px;
    }

    .comment-content>p {
        font-weight: 200;
        font-size: 15px;
        color: #777;
    }

    .number-rates {
        color: #8c8b8b;
        font-weight: 400;
        align-self: center;
    }

    .rate,
    .rateToSubmit {
        font-size: 25px;
        font-family: sans-serif;
        color: #ff8000;
        margin-left: 20px;
        margin-right: 20px;
    }

    .number-students {
        color: #8c8b8b;
        font-weight: 400;
        align-self: center;
        margin-left: 5px;
    }
</style>
{{/section}}



<div class="container-fluid d-flex justify-content-center">
    <div class="col-md-2 mx-3">
        <ul class="nav nav-pills flex-column" id="myTab" role="tablist">
            <li class="nav-item">
                <a class="nav-link active" id="des-tab" data-toggle="tab" href="#des" role="tab" aria-controls="des"
                    aria-selected="true">Curriculum</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" id="curr-tab" data-toggle="tab" href="#curr" role="tab" aria-controls="curr"
                    aria-selected="false">Description</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" id="sub-tab" data-toggle="tab" href="#sub" role="tab" aria-controls="sub"
                    aria-selected="false">Check Complete</a>
            </li>
        </ul>

    </div>
    <div class="mx-3" style="width: 100%;">
        <div class="tab-content" id="myTabContent">
            <div class="tab-pane fade show active" id="des" role="tabpanel" aria-labelledby="des-tab"
                style="min-width: 100%;">
                <h5 class="card-header d-flex justify-content-between">
                    {{course.name}}

                </h5>
                {{#if empty}}
                <div class="card-body">
                    <p class="card-text">Không có dữ liệu</p>
                </div>
                {{else}}
                <div class="card-body">
                    <div class="container-fluid d-flex justify-content-center pt-2"
                        style="background-color: #EDEFF0;min-height:700px;">
                        <div class="tab-content px-0 w-75">
                            <div id="curriculum" class="container tab-pane fade active show"><br>

                                {{#each course.curriculum}}
                                <p class="accordion d-flex justify-content-between">
                                    {{chapter_name}}
                                    <span class="end">
                                        <a class="btn btn-outline-success addletter1"
                                            data-addletforchap="/courses/edit/addletter/{{../course.slug}}/{{_id}}"
                                            data-toggle="modal" data-target="#AddLetter" href="javascript:;"
                                            role="button" title="Add letter">
                                            <i class="fa fa-plus active" aria-hidden="true"></i>

                                        </a>
                                        <a class="btn btn-outline-primary renamechapter1"
                                            data-editchap1="/courses/edit/renamechap/{{../course.slug}}/{{_id}}"
                                            data-chapname1="{{chapter_name}}" href="javascript:;" data-toggle="modal"
                                            data-target="#EditChap" role="button" title="Change chapter name">
                                            <i class="fa fa-pencil" aria-hidden="true"></i>

                                        </a>
                                        <a class="btn btn-outline-danger deletechapter1"
                                            data-deletechap1="/courses/edit/delelechap/{{../course.slug}}/{{../course._id}}/{{_id}}"
                                            href="javascript:;" data-toggle="modal" data-target="#DelChap" role="button"
                                            title="Delete this chapter">
                                            <i class="fa fa-trash" aria-hidden="true"></i>

                                        </a>


                                    </span>
                                </p>
                                <div class="panel p-0">
                                    <ul class="list-group">
                                        {{#each this.lectures}}
                                        <a href="#{{_id}}" data-toggle="modal" style="text-decoration: none;">
                                            <li class="list-group-item list-group-item-action border-0">

                                                {{name}}




                                            </li>
                                        </a>
                                        {{/each}}
                                    </ul>
                                </div>

                                {{/each}}
                                <div class="form-group d-flex p-3">
                                    <button type="button" class="btn btn-success" data-toggle="modal"
                                        data-target="#AddChapter">
                                        <i class="fa fa-plus" aria-hidden="true"></i>
                                        Add chapter
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                {{/if}}


            </div>
            <div class="tab-pane fade" id="curr" role="tabpanel" aria-labelledby="curr-tab">

                <div class="container-fluid my-3">
                    <img src="{{course.thumbnail}}" alt="">
                    <div class="my-2">
                        <a href="javascript:;" class="btn btn-outline-primary changeimg"
                            data-changeimg="/courses/edit/changeimg/{{course.slug}}" data-toggle="modal"
                            data-target="#ChangeImg" role="button">
                            <i class="fa fa-pencil" aria-hidden="true"></i>
                            Change image
                        </a>
                    </div>

                </div>
                <form action="/courses/edit/general/{{course.slug}}" id="frmEditGeneral" method="POST">


                    <div class="form-group">
                        <label for="exampleFormControlInput1"> Price </label>
                        <input type="text" class="form-control" id="exampleFormControlInput1"
                            placeholder="{{course.price}}" name="price" value="{{course.price}}">
                    </div>
                    <div class="form-group">
                        <label for="exampleFormControlSelect1">Discount</label>
                        <input type="text" class="form-control" id="exampleFormControlSelect1"
                            value="{{course.discount_price}}" name="discount_price">
                    </div>
                    <div class="form-group">
                        <label for="description">Description</label>
                        <textarea class="form-control" id="description" name="description">
                                    {{course.description}}
                                </textarea>
                    </div>

                </form>
                <div class="d-flex justify-content-center my-3">
                    <a href="javascript:;" class="btn btn-outline-success editgeneral1">
                        <i class="fa fa-check" aria-hidden="true"></i>
                        Save
                    </a>
                </div>

            </div>
            <div class="tab-pane fade" id="sub" role="tabpanel" aria-labelledby="sub-tab">
                <form action="/courses/complete/{{course.slug}}" method="POST">

                    <p>Please select your course status:</p>
                    <input type="radio" id="male" name="complete" value="1" checked="none">
                    <label for="male">Complete</label><br>
                    <input type="radio" id="female" name="complete" value="0" checked="{{status}}">
                    <label for="female">Inprogress</label><br>



                    <input type="submit" value="Submit">
                </form>
            </div>
        </div>
    </div>
</div>



{{#each course.curriculum}}
{{#each this.lectures}}
{{#ifCond link '===' ''}}
<div class="modal fade" id="{{_id}}" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle"
    aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content m-0" style="width: 608px;">
            <div class="modal-header">
                <div>
                    <h4 class="modal-title" id="exampleModalLongTitle">{{name}}</h4>
                </div>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body p-0">
                <h5> Video cua bai giang nay chua duoc dang</h5>
                {{{description}}}
            </div>
        </div>
    </div>
</div>
{{else}}
<div class="modal fade" id="{{_id}}" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle"
    aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content m-0" style="width: 608px;">
            <div class="modal-header">
                <div>
                    <h4 class="modal-title" id="exampleModalLongTitle">{{name}}</h4>
                </div>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body p-0">
                <video id="my-video" class="video-js" controls preload="auto" width="608" height="342" data-setup="{}">
                    <source src="{{link}}" type="video/mp4" />
                    <source src="MY_VIDEO.webm" type="video/webm" />
                    <p class="vjs-no-js">
                        To view this video please enable JavaScript, and consider upgrading to a
                        web browser that
                        <a href="https://videojs.com/html5-video-support/" target="_blank">supports HTML5 video</a>
                    </p>
                </video>

                {{{description}}}
            </div>
        </div>
    </div>
</div>
{{/ifCond}}
{{/each}}
{{/each}}



<!-- Modal -->
<div class="modal fade" id="AddChapter" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Add chapter</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <form action="/courses/edit/addchapter/{{course.slug}}" method="POST" id="frmAddChapter">
                    <div class="form-group">
                        <label for="txtChap">Chapter name</label>
                        <input type="text" class="form-control" name="chapter_name" id="txtChap">
                    </div>

                </form>
                <span class="form-message-chapter" style="color: red;"></span>
            </div>
            <div class="modal-footer">
                <a class="btn btn-outline-success addchapter" href="javascript:;" role="button">
                    <i class="fa fa-check" aria-hidden="true"></i>
                    Save
                </a>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="AddLetter" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Add letter</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <form action="" method="POST" id="frmAddLetter" enctype="multipart/form-data">
                    <div class="form-group">
                        <label for="txtLet">Letter name</label>
                        <input type="text" class="form-control" name="name" id="txtLet">
                        <p class="form-message-letter" style="color: red;"></p>
                        <label for="vidLet">Letter video</label>
                        <input id="letter-vid" name="letter-vid" type="file">
                        <p class="form-message-letter-vid" style="color: red;"></p>

                    </div>

                </form>

            </div>
            <div class="modal-footer">
                <a class="btn btn-outline-success addletter" href="javascript:;" role="button">
                    <i class="fa fa-check" aria-hidden="true"></i>
                    Save
                </a>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="EditChap" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Edit chapter name</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <form action="" method="POST" id="frmEditChap">
                    <div class="form-group">
                        <label for="txtEditChap">Chapter name</label>
                        <input type="text" class="form-control" name="name" id="txtEditChap">
                        <p class="form-message-letter" style="color: red;"></p>


                    </div>

                </form>

            </div>
            <div class="modal-footer">
                <a class="btn btn-outline-success editchaptername" href="javascript:;" role="button">
                    <i class="fa fa-check" aria-hidden="true"></i>
                    Save
                </a>

            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="DelChap" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Delete chapter</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <form action="" method="POST" id="frmDelChap">

                </form>
                <h3>Chapter will be deleted permanently</h3>

            </div>
            <div class="modal-footer">
                <a class="btn btn-outline-danger deletechap" href="javascript:;" role="button">
                    <i class="fa fa-trash" aria-hidden="true"></i>
                    Delete
                </a>

            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="ChangeImg" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Change image</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <form action="" method="POST" id="frmChangeImg" enctype="multipart/form-data">
                    <div class="form-group">

                        <label for="img-course">New image </label>
                        <input id="img-course" name="img-course" type="file">
                        <p class="form-message-img-course" style="color: red;"></p>

                    </div>

                </form>

            </div>
            <div class="modal-footer">
                <a class="btn btn-outline-success changeimg" href="javascript:;" role="button">
                    <i class="fa fa-check" aria-hidden="true"></i>
                    Save
                </a>
            </div>
        </div>
    </div>
</div>

{{#section 'js'}}
<script src="https://code.jquery.com/jquery-3.5.1.min.js"
    integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.min.js"></script>

<script src="/public/javascripts/validator.js"></script>
<script
    src="https://cdn.tiny.cloud/1/27g7modnmc4qdzsocnz7v44i7di0kfc7x2txeylvfvrzjsei/tinymce/5/tinymce.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-fileinput/5.1.3/js/fileinput.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-fileinput/5.1.3/themes/fa/theme.min.js"></script>

<script>





    $('.addletter1').on('click', function () {
        var id1 = $(this).data('addletforchap');
        console.log(id1);
        $('#frmAddLetter').attr('action', id1);

    });

    $('.changeimg').on('click', function () {
        var id1 = $(this).data('changeimg');

        $('#frmChangeImg').attr('action', id1);

    });


    $('.deletechapter1').on('click', function () {
        var id1 = $(this).data('deletechap1');

        $('#frmDelChap').attr('action', id1);

    });


    $('.renamechapter1').on('click', function () {

        var id2 = $(this).data('editchap1');
        var val = $(this).data('chapname1');
        console.log(id2);
        console.log("asdfasdfa");
        $('#txtEditChap').val(val);

        $('#frmEditChap').attr('action', id2);

    });


    $(document).ready(function () {
        $('.addchapter').on('click', function () {
            var val = $("#txtChap").val();
            if (val === '') {
                $('.form-message-chapter').html('Nhập tên chapter');
            }
            else {
                $('#frmAddChapter').submit();
            }

        });

        $('.addletter').on('click', function () {

            var val = $("#txtLet").val();
            var valvid = $("#letter-vid").val();
            if (val === '') {
                $('.form-message-letter').html('Nhập tên letter');
            }
            else if (valvid === '') {
                $('.form-message-letter-vid').html('chọn video');
            }
            else {
                $('#frmAddLetter').submit();
            }

        });


        $('.changeimg').on('click', function () {

            var val = $("#img-course").val();

            if (val === '') {
                $('.form-message-letter').html('Nhập tên letter');
            }

            else {
                $('#frmChangeImg').submit();
            }

        });


        $('.editchaptername').on('click', function () {

            var val = $("#txtEditChap").val();
            if (val === '') {
                $('.form-message-letter').html('Nhập tên chapter');
            }

            else {
                $('#frmEditChap').submit();
            }

        });


        $('.editgeneral1').on('click', function () {
            console.log("editenelasdfasdf");
            $('#frmEditGeneral').submit();

        });

        $('.deletechap').on('click', function () {

            $('#frmDelChap').submit();

        });

        $("#letter-vid").fileinput({
            theme: 'fa',
            dropZoneEnabled: false,
            maxFileCount: 1,
            allowedFileExtensions: ["mp4"]
        });

        $("#img-course").fileinput({
            theme: 'fa',
            dropZoneEnabled: false,
            maxFileCount: 1,
            allowedFileExtensions: ["jpg", "png", "gif"]
        });

        tinymce.init({
            selector: '#description',
            height: 500,
            plugins: 'paste image link autolink lists table media',
            toolbar: [
                'undo redo | bold italic underline strikethrough | numlist bullist | alignleft aligncenter alignright | forecolor backcolor | table link image media',
            ],
        });
    });





    /* Validator({
        form: '#frmAddChapter',
        formGroup: '.form-group',
        errorSelector: '.form-message',
        rules: [
            Validator.isRequired('#txtChap', 'Nhập tên chapter'),

        ],
    });*/


    //Accordition
    var acc = document.getElementsByClassName("accordion");
    var i;

    for (i = 0; i < acc.length; i++) {
        acc[i].addEventListener("click", function () {
            this.classList.toggle("acor-active");
            var panel = this.nextElementSibling;
            if (panel.style.maxHeight) {
                panel.style.maxHeight = null;
            } else {
                panel.style.maxHeight = panel.scrollHeight + "px";
            }
        });
    };



</script>
{{/section}}